Sub ExtraireTousBlocsVoyage()
    Dim ws As Worksheet, newWs As Worksheet
    Dim i As Long, rowNum As Long, lastRow As Long
    Dim startRow As Long, endRow As Long
    Dim inBloc As Boolean
    Dim sheetCount As Integer
    Dim newSheetName As String
    Dim rngToCopy As Range
    Dim cell As Range
    
    Application.ScreenUpdating = False
    sheetCount = 1
    
    For Each ws In ThisWorkbook.Worksheets
        lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
        startRow = 0
        inBloc = False
        
        For rowNum = 1 To lastRow
            Set cell = Nothing
            On Error Resume Next
            Set cell = ws.Rows(rowNum).Find(What:="voyage", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, MatchCase:=False)
            On Error GoTo 0
            
            If Not cell Is Nothing Then
                If inBloc Then
                    ' Fin du bloc précédent, copier de startRow à rowNum - 1
                    endRow = rowNum - 1
                    Call CopierBloc(ws, startRow, endRow, sheetCount)
                    sheetCount = sheetCount + 1
                End If
                ' Nouveau bloc commence ici
                startRow = rowNum
                inBloc = True
            End If
        Next rowNum
        
        ' Fin de feuille : copier le dernier bloc si en cours
        If inBloc Then
            endRow = lastRow
            Call CopierBloc(ws, startRow, endRow, sheetCount)
            sheetCount = sheetCount + 1
        End If
    Next ws

    Application.ScreenUpdating = True
    MsgBox (sheetCount - 1) & " onglet(s) créés pour les blocs contenant 'voyage'.", vbInformation
End Sub

Sub CopierBloc(sourceWs As Worksheet, startRow As Long, endRow As Long, index As Integer)
    Dim newWs As Worksheet
    Dim newSheetName As String
    Dim rngToCopy As Range

    newSheetName = "Voyage"
    If index > 1 Then newSheetName = newSheetName & " (" & index & ")"
    Do While SheetExists(newSheetName)
        index = index + 1
        newSheetName = "Voyage (" & index & ")"
    Loop

    Set newWs = Worksheets.Add(After:=Worksheets(Worksheets.Count))
    newWs.Name = newSheetName

    Set rngToCopy = sourceWs.Rows(startRow & ":" & endRow)
    rngToCopy.Copy Destination:=newWs.Range("A1")

    ' Mise en forme
    With newWs.UsedRange
        .Font.Bold = True
        .Interior.Color = RGB(230, 240, 255)
        .Columns.AutoFit
    End With
End Sub

Function SheetExists(sheetName As String) As Boolean
    On Error Resume Next
    SheetExists = Not Worksheets(sheetName) Is Nothing
    On Error GoTo 0
End Function