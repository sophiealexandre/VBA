Sub ExtraireBlocsVoyage()
    Dim ws As Worksheet, newWs As Worksheet
    Dim c As Range, r As Range
    Dim lastRow As Long, startRow As Long, endRow As Long
    Dim i As Integer
    Dim newSheetName As String
    Dim blocEnCours As Boolean
    
    Application.ScreenUpdating = False
    i = 1

    For Each ws In ThisWorkbook.Worksheets
        lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
        startRow = 0
        blocEnCours = False
        
        For rowNum = 1 To lastRow
            For Each c In ws.Rows(rowNum).Cells
                If LCase(c.Value) Like "*voyage*" Then
                    If blocEnCours Then
                        endRow = rowNum - 1
                        Call CopierBloc(ws, startRow, endRow, i)
                        i = i + 1
                    End If
                    startRow = rowNum
                    blocEnCours = True
                    Exit For
                End If
            Next c
        Next rowNum
        
        ' Traiter le dernier bloc si nécessaire
        If blocEnCours Then
            endRow = lastRow
            Call CopierBloc(ws, startRow, endRow, i)
            i = i + 1
        End If
    Next ws

    Application.ScreenUpdating = True
    MsgBox (i - 1) & " bloc(s) contenant 'voyage' exporté(s)", vbInformation
End Sub

Sub CopierBloc(sourceWs As Worksheet, startRow As Long, endRow As Long, index As Integer)
    Dim newWs As Worksheet
    Dim newSheetName As String
    Dim rngToCopy As Range

    newSheetName = "Voyage"
    If index > 1 Then newSheetName = newSheetName & " (" & index & ")"
    Do While SheetExists(newSheetName)
        index = index + 1
        newSheetName = "Voyage (" & index & ")"
    Loop

    Set newWs = Worksheets.Add(After:=Worksheets(Worksheets.Count))
    newWs.Name = newSheetName

    Set rngToCopy = sourceWs.Rows(startRow & ":" & endRow)
    rngToCopy.Copy Destination:=newWs.Range("A1")

    ' Mise en forme
    With newWs.UsedRange
        .Font.Bold = True
        .Interior.Color = RGB(230, 240, 255)
        .Columns.AutoFit
    End With
End Sub

Function SheetExists(sheetName As String) As Boolean
    On Error Resume Next
    SheetExists = Not Worksheets(sheetName) Is Nothing
    On Error GoTo 0
End Function