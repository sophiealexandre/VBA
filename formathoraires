Sub ExtraireVoyagesSeparés()
    Dim ws As Worksheet, newWs As Worksheet
    Dim cell As Range, c As Range
    Dim i As Integer, nextRow As Long
    Dim newSheetName As String
    Dim found As Boolean
    
    Application.ScreenUpdating = False
    i = 1
    
    ' Parcourir toutes les feuilles
    For Each ws In ThisWorkbook.Worksheets
        For Each c In ws.UsedRange
            If LCase(c.Value) Like "*voyage*" Then
                ' Créer un nom unique pour la feuille
                newSheetName = "Voyage"
                If i > 1 Then newSheetName = newSheetName & " (" & i & ")"
                Do While SheetExists(newSheetName)
                    i = i + 1
                    newSheetName = "Voyage (" & i & ")"
                Loop
                
                ' Créer la nouvelle feuille
                Set newWs = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
                newWs.Name = newSheetName
                
                ' Copier la ligne contenant le mot "voyage"
                c.EntireRow.Copy Destination:=newWs.Range("A1")
                
                ' Copier la ligne suivante si elle existe
                On Error Resume Next
                c.Offset(1, 0).EntireRow.Copy Destination:=newWs.Range("A2")
                On Error GoTo 0
                
                ' Mise en forme
                With newWs.UsedRange
                    .Font.Bold = True
                    .Interior.Color = RGB(230, 240, 255)
                    .Columns.AutoFit
                End With
                
                i = i + 1
            End If
        Next c
    Next ws

    Application.ScreenUpdating = True
    MsgBox (i - 1) & " feuille(s) créées avec lignes contenant 'voyage'", vbInformation
End Sub

Function SheetExists(sheetName As String) As Boolean
    On Error Resume Next
    SheetExists = Not Worksheets(sheetName) Is Nothing
    On Error GoTo 0
End Function