Sub ExportHTMLFromI_OpenOnly()
    Dim WordApp As Object
    Dim WordDoc As Object
    Dim ws As Worksheet
    Dim i As Integer
    Dim htmlText As String
    Dim objHtml As Object
    Dim objElements As Object
    Dim objElement As Object

    ' D√©finir la feuille active
    Set ws = ThisWorkbook.Sheets(1)
    
    ' D√©marrer Word
    Set WordApp = CreateObject("Word.Application")
    WordApp.Visible = True ' Word est visible

    ' Boucle sur les 10 premi√®res lignes
    For i = 1 To 10
        htmlText = ws.Cells(i, 9).Value ' Colonne I = contenu HTML
        
        If Trim(htmlText) <> "" Then
            ' Charger le HTML
            Set objHtml = CreateObject("htmlfile")
            objHtml.Open
            objHtml.Write htmlText
            objHtml.Close

            ' Nouveau document Word
            Set WordDoc = WordApp.Documents.Add

            ' R√©cup√©rer tous les √©l√©ments HTML
            Set objElements = objHtml.getElementsByTagName("*")

            ' V√©rifier que objElements est valide avant de boucler
            If Not objElements Is Nothing Then
                For Each objElement In objElements
                    Select Case LCase(objElement.tagName)
                        Case "h1"
                            AddText WordDoc, objElement.innerText, "Heading 1"
                        Case "h2"
                            AddText WordDoc, objElement.innerText, "Heading 2"
                        Case "h3"
                            AddText WordDoc, objElement.innerText, "Heading 3"
                        Case "p"
                            If Trim(objElement.innerText) <> "" Then
                                AddText WordDoc, objElement.innerText, "Normal"
                            End If
                        Case "br"
                            WordDoc.Content.InsertAfter vbCrLf
                        Case "ul"
                            ' Ne rien faire ici
                        Case "li"
                            If Trim(objElement.innerText) <> "" Then
                                AddBullet WordDoc, objElement.innerText
                            End If
                    End Select
                Next objElement
            End If

            ' üõë PAS DE SAVEAS ! Le document reste ouvert non enregistr√©
        End If
    Next i

    ' WordApp.Visible = True d√©j√† mis avant (Word restera ouvert)
    
    MsgBox "Tous les documents sont cr√©√©s et ouverts. √Ä vous de les enregistrer."
End Sub

' ‚û°Ô∏è Ajouter du texte avec style
Sub AddText(ByRef WordDoc As Object, ByVal txt As String, ByVal styleName As String)
    With WordDoc.Content.Paragraphs.Last.Range
        .Text = txt
        .Style = styleName
    End With
    WordDoc.Content.Paragraphs.Add
End Sub

' ‚û°Ô∏è Ajouter une puce de liste
Sub AddBullet(ByRef WordDoc As Object, ByVal txt As String)
    With WordDoc.Content.Paragraphs.Last.Range
        .Text = txt
        .Style = "List Paragraph"
        .ListFormat.ApplyBulletDefault
    End With
    WordDoc.Content.Paragraphs.Add
End Sub
