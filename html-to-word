Sub ExportHTMLFromI_OpenOnly_NoStyleError()
    Dim WordApp As Object
    Dim WordDoc As Object
    Dim ws As Worksheet
    Dim i As Integer
    Dim htmlText As String
    Dim objHtml As Object
    Dim objElements As Object
    Dim objElement As Object

    ' D√©finir la feuille active
    Set ws = ThisWorkbook.Sheets(1)
    
    ' D√©marrer Word
    Set WordApp = CreateObject("Word.Application")
    WordApp.Visible = True ' Word sera visible

    ' Boucle sur les 10 premi√®res lignes
    For i = 1 To 10
        htmlText = ws.Cells(i, 9).Value ' Colonne I = contenu HTML
        
        If Trim(htmlText) <> "" Then
            ' Charger le HTML
            Set objHtml = CreateObject("htmlfile")
            objHtml.Open
            objHtml.Write htmlText
            objHtml.Close

            ' Nouveau document Word
            Set WordDoc = WordApp.Documents.Add

            ' R√©cup√©rer tous les √©l√©ments HTML
            Set objElements = objHtml.getElementsByTagName("*")

            ' V√©rifier que objElements est valide avant de boucler
            If Not objElements Is Nothing Then
                For Each objElement In objElements
                    Select Case LCase(objElement.tagName)
                        Case "h1"
                            AddText WordDoc, objElement.innerText, "Heading 1"
                        Case "h2"
                            AddText WordDoc, objElement.innerText, "Heading 2"
                        Case "h3"
                            AddText WordDoc, objElement.innerText, "Heading 3"
                        Case "p"
                            If Trim(objElement.innerText) <> "" Then
                                AddText WordDoc, objElement.innerText, "Normal"
                            End If
                        Case "br"
                            WordDoc.Content.InsertAfter vbCrLf
                        Case "ul"
                            ' Ne rien faire
                        Case "li"
                            If Trim(objElement.innerText) <> "" Then
                                AddBullet WordDoc, objElement.innerText
                            End If
                    End Select
                Next objElement
            End If

            ' üõë PAS DE SAVEAS ICI : Le document reste ouvert non enregistr√©
        End If
    Next i

    ' WordApp.Visible = True d√©j√† activ√© (Word reste ouvert)
    
    MsgBox "Tous les documents Word sont cr√©√©s et ouverts. Vous pouvez les enregistrer vous-m√™me."
End Sub

' ‚û°Ô∏è Ajoute du texte avec style (tol√©rant si le style n'existe pas)
Sub AddText(ByRef WordDoc As Object, ByVal txt As String, Optional ByVal styleName As String = "")
    With WordDoc.Content.Paragraphs.Last.Range
        .Text = txt
        On Error Resume Next ' Ignore erreur de style
        If styleName <> "" Then .Style = styleName
        On Error GoTo 0 ' Revenir au comportement normal
    End With
    WordDoc.Content.Paragraphs.Add
End Sub

' ‚û°Ô∏è Ajoute une puce de liste (tol√©rant si le style n'existe pas)
Sub AddBullet(ByRef WordDoc As Object, ByVal txt As String)
    With WordDoc.Content.Paragraphs.Last.Range
        .Text = txt
        On Error Resume Next
        .Style = "List Paragraph"
        .ListFormat.ApplyBulletDefault
        On Error GoTo 0
    End With
    WordDoc.Content.Paragraphs.Add
End Sub
